# DatingClient

–ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–µ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ –Ω–∞ –±–∞–∑–µ **MAUI (.NET 8.0)** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π iOS, Android.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
- [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ](#—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-—Å–∏—Å—Ç–µ–º–µ)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–æ–≤](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∏-—Å–µ—Ä–≤–∏—Å—ã-–¥–∞–Ω–Ω—ã—Ö)
- [ViewModel –ø–∞—Ç—Ç–µ—Ä–Ω](#viewmodel-–ø–∞—Ç—Ç–µ—Ä–Ω-–∏-–ø—Ä–∏–≤—è–∑–∫–∞-–¥–∞–Ω–Ω—ã—Ö)
- [–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö](#–ø–æ—Ç–æ–∫-–¥–∞–Ω–Ω—ã—Ö-–∏-—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- [Build –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ](#Build-–∏-—Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ)

**üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:** —Å–º. [`README_EXTENDED.md`](README_EXTENDED.md) –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –∫–æ–¥–∞ –∏ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º

## –û–±–∑–æ—Ä

**DatingClient** ‚Äî —ç—Ç–æ –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤ —Å –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º:

- üîê –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–æ—Ñ–∏–ª–µ–º
- üë• –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º —Ñ–∏–ª—å—Ç—Ä–æ–≤
- ‚ù§Ô∏è –õ–∞–π–∫–∞—Ç—å –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –ª–∞–π–∫–∏
- üí¨ –û–±—â–∞—Ç—å—Å—è –≤ —á–∞—Ç–∞—Ö —Å –¥—Ä—É–≥–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìç –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é
- üé® –£–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å—é
- üóÇÔ∏è –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–≤–∞—Ç–∞—Ä—ã –∏ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–µ–π

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∏ –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                 | –í–µ—Ä—Å–∏—è  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                       |
| ------------------------- | ------- | -------------------------------- |
| **.NET**                  | 8.0     | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏             |
| **MAUI**                  | Latest  | –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π UI —Ñ—Ä–µ–π–º–≤–æ—Ä–∫  |
| **CommunityToolkit.Maui** | 9.1.1   | –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ MAUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã      |
| **CommunityToolkit.MVVM** | 8.3.0   | MVVM –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã      |
| **Newtonsoft.Json**       | 13.0.3  | JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è/–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è |
| **sqlite-net-pcl**        | 1.9.172 | –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö       |

### –¶–µ–ª–µ–≤—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã:

- ü§ñ **Android** 21.0+
- üçé **iOS** 11.0+

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω **MVVM (Model-View-ViewModel)** —Å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           User Interface                ‚îÇ
‚îÇ    (Views: XAML + Code-Behind)          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        ViewModel Layer                   ‚îÇ
‚îÇ  (Business Logic, State Management)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ        Services Layer                    ‚îÇ
‚îÇ (ApiService, SocketService, CacheService)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ
                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      Models & Data Access                ‚îÇ
‚îÇ    (SQLite, REST API, WebSocket)         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
DatingClient/
‚îú‚îÄ‚îÄ üìÑ App.xaml                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìÑ App.xaml.cs                 # –õ–æ–≥–∏–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ üìÑ AppShell.xaml               # –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ üìÑ Constants.cs                # –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îú‚îÄ‚îÄ üìÑ MauiProgram.cs              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Converters/                 # XAML –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ BoolToColorConverter.cs     # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è bool ‚Üí Color
‚îÇ   ‚îú‚îÄ‚îÄ BoolToLayoutConverter.cs    # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è bool ‚Üí StackLayout
‚îÇ   ‚îú‚îÄ‚îÄ GenderJsonConverter.cs      # JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–∞
‚îÇ   ‚îú‚îÄ‚îÄ GenderToStringConverter.cs  # Gender ‚Üí String
‚îÇ   ‚îú‚îÄ‚îÄ InverseBoolConverter.cs     # –ò–Ω–≤–µ—Ä—Å–∏—è boolean
‚îÇ   ‚îî‚îÄ‚îÄ NullableToBoolConverter.cs  # null ‚Üí false –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Helpers/                    # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ AuthHelper.cs              # –†–∞–±–æ—Ç–∞ —Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ GenderHelper.cs            # –†–∞–±–æ—Ç–∞ —Å –ø–æ–ª–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ QueryHelper.cs             # –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ query –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ StorageHelper.cs           # –†–∞–±–æ—Ç–∞ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Models/                     # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ Auth.cs                    # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ ChatSummary.cs             # –ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —á–∞—Ç–µ
‚îÇ   ‚îú‚îÄ‚îÄ IUpdatable.cs              # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–Ω–æ–≤–ª—è–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ LocationSuggestion.cs      # –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Message.cs                 # –°–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç–µ
‚îÇ   ‚îú‚îÄ‚îÄ SearchFilter.cs            # –§–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ User.cs                    # –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ UserProfile.cs             # –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îî‚îÄ‚îÄ WSMessage.cs               # WebSocket —Å–æ–æ–±—â–µ–Ω–∏–µ
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Services/                   # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ ApiService.cs              # REST API –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ AvatarCacheService.cs      # –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ CacheService.cs            # –û–±—â–µ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ LocationService.cs         # –†–∞–±–æ—Ç–∞ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ SocketService.cs           # WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Utils/                      # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ LimitedDeque.cs            # –î–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –æ—á–µ—Ä–µ–¥—å —Å –ª–∏–º–∏—Ç–æ–º
‚îÇ
‚îú‚îÄ‚îÄ üìÅ ViewModels/                 # ViewModel —Å–ª–æ–π
‚îÇ   ‚îú‚îÄ‚îÄ ChatsViewModel.cs          # VM –¥–ª—è —Å–ø–∏—Å–∫–∞ —á–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ LikesViewModel.cs          # VM –¥–ª—è –ª–∞–π–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ LoginViewModel.cs          # VM –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ MessagesViewModel.cs       # VM –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–µ
‚îÇ   ‚îú‚îÄ‚îÄ ProfilePopupViewModel.cs   # VM –¥–ª—è –ø–æ–ø–∞–ø –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ ProfileViewModel.cs        # VM –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ SearchViewModel.cs         # VM –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π
‚îÇ   ‚îî‚îÄ‚îÄ SettingsViewModel.cs       # VM –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Views/                      # UI —Å–ª–æ–π (XAML + Code-Behind)
‚îÇ   ‚îú‚îÄ‚îÄ ChatsPage.xaml(.cs)        # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ FilterPopup.xaml(.cs)      # –ü–æ–ø–∞–ø —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ LikesPage.xaml(.cs)        # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–∞–π–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ LoadingOverlay.xaml(.cs)   # –û–≤–µ—Ä–ª–µ–π –∑–∞–≥—Ä—É–∑–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ LoginPage.xaml(.cs)        # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ MessagesPage.xaml(.cs)     # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ ProfilePage.xaml(.cs)      # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ ProfilePopup.xaml(.cs)     # –ü–æ–ø–∞–ø –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ SearchPage.xaml(.cs)       # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ SettingsPage.xaml(.cs)     # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Resources/                  # –†–µ—Å—É—Ä—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ AppIcon/                   # –ò–∫–æ–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Fonts/                     # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —à—Ä–∏—Ñ—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ Images/                    # –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ Raw/                       # –°—ã—Ä—ã–µ —Ä–µ—Å—É—Ä—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ Splash/                    # –ó–∞—Å—Ç–∞–≤–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ Styles/                    # XAML —Å—Ç–∏–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ üìÅ Platforms/                  # –ü–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ Android/                   # Android —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ iOS/                       # iOS —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ MacCatalyst/               # macOS —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ Tizen/                     # Tizen —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ Windows/                   # Windows —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ
‚îî‚îÄ‚îÄ üìÅ Properties/
    ‚îî‚îÄ‚îÄ launchSettings.json        # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–∏—Å—Ç–µ–º–µ

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

- **Visual Studio 2022** (v17.3+) –∏–ª–∏ **Rider** (2024.1+)
- **.NET 8.0 SDK**
- **Java Development Kit (JDK)** 11+ (–¥–ª—è Android)
- **Android SDK** (API Level 21+)
- **Xcode** 14+ (–¥–ª—è iOS, —Ç—Ä–µ–±—É–µ—Ç—Å—è macOS)

### –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º:

- **Android:** API Level 21 (5.0 Lollipop)
- **iOS:** –≤–µ—Ä—Å–∏—è 11.0 –∏ –≤—ã—à–µ

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/dmMorsh/DatingClient.git
cd DatingClient
```

### 2. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
dotnet restore
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `Constants.cs` –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ URL –≤–∞—à–µ–≥–æ API —Å–µ—Ä–≤–µ—Ä–∞:

```csharp
public const string ApiBaseUrl = "http://192.168.0.12:8088";
// –∏–ª–∏ –¥–ª—è production
public const string ApiBaseUrl = "https://your-domain.com";
```

### 4. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
# –°–±–æ—Ä–∫–∞ –¥–ª—è –≤—Å–µ—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
dotnet build

# –ò–ª–∏ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
dotnet build -f net8.0-android
dotnet build -f net8.0-ios
```

### 5. –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# Android
dotnet build -t Run -f net8.0-android

# iOS (—Ç—Ä–µ–±—É–µ—Ç—Å—è macOS)
dotnet build -t Run -f net8.0-ios
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Constants.cs

–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```csharp
public static class Constants
{
    // API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    public const string ApiBaseUrl = "http://192.168.0.12:8088";

    // –ö–ª—é—á–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
    public const string UserId = "user_id";
    public const string AccessToken = "access_token";
    public const string RefreshToken = "refresh_token";
    public const string DeviceId = "device_id";

    // WebSocket —Å–æ–±—ã—Ç–∏—è
    public const string Message = "message";
    public const string Match = "match";
}
```

### MauiProgram.cs

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Dependency Injection:

```csharp
public static class MauiProgram
{
    public static MauiApp CreateMauiApp()
    {
        var builder = MauiApp.CreateBuilder();
        builder
            .UseMauiApp<App>()
            .ConfigureFonts(fonts => { /* ... */ })
            .UseMauiCommunityToolkit();

        // –°–µ—Ä–≤–∏—Å—ã (Singleton)
        builder.Services.AddSingleton<ApiService>();
        builder.Services.AddSingleton<CacheService>();
        builder.Services.AddSingleton<SocketService>();
        builder.Services.AddSingleton<AvatarCacheService>();
        builder.Services.AddSingleton<LocationService>();

        // ViewModels –∏ Views (Transient)
        builder.Services.AddTransient<LoginViewModel>();
        builder.Services.AddTransient<LoginPage>();
        // ... –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏ ViewModels

        return builder.Build();
    }
}
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ –≤ —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∏ refresh —Ç–æ–∫–µ–Ω–∞–º–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ–∞–Ω—Å–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏

**–õ–æ–≥–∏–∫–∞:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç credentials
           ‚Üì
API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç access_token + refresh_token
           ‚Üì
–¢–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ Preferences
           ‚Üì
–ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è Bearer token –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫
           ‚Üì
–ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–∞ 401 –æ—à–∏–±–∫–∞ ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π Refresh
           ‚Üì
–ü–æ–≤—Ç–æ—Ä –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
```

**–ù—é–∞–Ω—Å—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

- `ApiService.SendWithRetry()` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ 401 –æ—à–∏–±–∫–µ
- –í `DEBUG` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π API –∞–¥—Ä–µ—Å –∏–∑ `Constants.cs`
- –í `RELEASE` –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥—Ä–µ—Å –∏–∑ `Preferences` (–ø–æ–∑–≤–æ–ª—è–µ—Ç –º–µ–Ω—è—Ç—å —Å–µ—Ä–≤–µ—Ä –±–µ–∑ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏)
- Refresh —Ç–æ–∫–µ–Ω –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç–µ–ª–µ POST –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ `/refresh`

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞ (–∑–∞ 1-2 –º–∏–Ω—É—Ç—ã –¥–æ –∏—Å—Ç–µ—á–µ–Ω–∏—è)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ refresh –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –î–æ–±–∞–≤–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ refresh –ø–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–§–∞–π–ª—ã:** `LoginViewModel.cs`, `AuthHelper.cs`, `Auth.cs`, `ApiService.cs`

---

### üë• –ö–∞—Ä—É—Å–µ–ª—å –ø—Ä–æ—Ñ–∏–ª–µ–π –∏ –ø–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –ö–∞—Ä—É—Å–µ–ª—å —Å–≤–∞–π–ø–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø—Ä–æ—Ñ–∏–ª–µ–π
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–ø–æ–ª, –≤–æ–∑—Ä–∞—Å—Ç, –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –º–µ–∂–¥—É —Å–µ–∞–Ω—Å–∞–º–∏
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —Å–≤–∞–π–ø–∞ (undo —Ñ—É–Ω–∫—Ü–∏—è)

**–ì–ª—É–±–æ–∫–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

#### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤

```csharp
// –ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ —Ñ–∏–ª—å—Ç—Ä—ã –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
Filter = new SearchFilter
{
    InterestedIn = me.Gender,           // –ö–∞–∫–æ–π –ø–æ–ª –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
    Gender = me.InterestedIn,           // –ü–æ–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    MinAge = me.Age - 1,
    MaxAge = me.Age + 1,
    Latitude = me.Latitude,             // –¢–µ–∫—É—â–µ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
    Longitude = me.Longitude,
    MaxDistanceKm = 10,                 // –†–∞–¥–∏—É—Å –ø–æ–∏—Å–∫–∞
};
StorageHelper.SaveSearchFilter(Filter); // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
```

#### 2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∏—Å–∫–∞

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **LimitedDeque** (–¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω—è—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –æ—á–µ—Ä–µ–¥—å):

- **–û—Å–Ω–æ–≤–Ω–æ–π –±—É—Ñ–µ—Ä:** –º–∞–∫—Å–∏–º—É–º 50 –ø—Ä–æ—Ñ–∏–ª–µ–π –¥–ª—è —Å–≤–∞–π–ø–∞
- **Undo –±—É—Ñ–µ—Ä:** –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 –¥–µ–π—Å—Ç–≤–∏–π –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å
- **Current pointer:** —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º—ã–π –ø—Ä–æ—Ñ–∏–ª—å

```
[User1] ‚Üê [User2] ‚Üê [User3] (Current) ‚Üí [User4] ‚Üí [User5]
         ‚Üë_______UNDO BUFFER (5 items)_______‚Üë
         ‚Üë___________MAIN BUFFER (50 items)____________‚Üë
```

#### 3. –ü–æ–∏—Å–∫ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

```csharp
const int PageSize = 20;  // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è 20 –ø—Ä–æ—Ñ–∏–ª–µ–π –∑–∞ —Ä–∞–∑
_lastSeenId              // ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è (–¥–ª—è –∫—É—Ä—Å–æ—Ä–∞)

// –õ–æ–≥–∏–∫–∞:
1. –ó–∞–ø—Ä–æ—Å –∏–¥—ë—Ç —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –±—É—Ñ–µ—Ä –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è (< 15 —ç–ª–µ–º–µ–Ω—Ç–æ–≤)
2. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è ID –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ª–µ–¥—É—é—â–µ–π –ø–∞—Ä—Ç–∏–∏
3. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
4. –ü—Ä–∏ _endReached = true –±–æ–ª—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ –∏–¥—É—Ç
```

#### 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤

- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º –∫—ç—à–µ
- –ï—Å–ª–∏ –µ—Å—Ç—å ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `LocalAvatarPath`, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –¥–∏—Å–∫–∞
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ø–∞–ø–∫—É `AppDataDirectory`
- –°–Ω–∏–∂–∞–µ—Ç —Ç—Ä–∞—Ñ–∏–∫ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø—Ä–æ–∫—Ä—É—Ç–∫–µ –≤ 90%+

**–ù—é–∞–Ω—Å—ã:**

- `Location` –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –ø–æ–ª–µ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è)
- `LocationPlaceholder` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏–±–æ —Ç–µ–∫—É—â–∏–π –≤–≤–æ–¥, –ª–∏–±–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ
- –§–∏–ª—å—Ç—Ä—ã –ø–µ—Ä—Å–∏—Å—Ç–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏, –Ω–µ —Ç–µ—Ä—è—é—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º/—Ö–æ–±–±–∏ (—Ç—Ä–µ–±—É–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è `SearchFilter`)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "—É–º–Ω—ã–π –ø–æ–∏—Å–∫" ‚Äî –µ—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –æ—Å—Ç–∞–ª–æ—Å—å –º–∞–ª–æ, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å—à–∏—Ä—è—Ç—å —Ä–∞–¥–∏—É—Å
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ñ–∏–ª—å—Ç—Ä–∞ –Ω–∞ 5-10 –º–∏–Ω—É—Ç, —á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å –ø—Ä–∏ –º–∞–ª—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö —Ñ–∏–ª—å—Ç—Ä–∞
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–æ—Å—Ç–∞–ª–æ—Å—å –ø—Ä–æ—Ñ–∏–ª–µ–π" –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –∏–∑–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∞–≤–∞—Ç–∞—Ä–æ–≤ (–∑–∞–≥—Ä—É–∂–∞—Ç—å –Ω–∏–∑–∫–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ø–æ–ª–Ω–æ–µ –ø—Ä–∏ –∫–ª–∏–∫–µ)

**–§–∞–π–ª—ã:** `SearchViewModel.cs`, `SearchPage.xaml`, `AvatarCacheService.cs`, `LimitedDeque.cs`, `SearchFilter.cs`

---

### ‚ù§Ô∏è –°–∏—Å—Ç–µ–º–∞ –ª–∞–π–∫–æ–≤ –∏ –º–∞—Ç—á–µ–π

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –û—Ç–ø—Ä–∞–≤–∫–∞ –ª–∞–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—é
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ª–∞–π–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –≤–∑–∞–∏–º–Ω—ã—Ö –ª–∞–π–∫–∞—Ö (–º–∞—Ç—á–∞—Ö)
- –ò—Å—Ç–æ—Ä–∏—è –ª–∞–π–∫–æ–≤

**–õ–æ–≥–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å A —Å–≤–∞–π–ø–∞–µ—Ç –≤–ø—Ä–∞–≤–æ –Ω–∞ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è B
           ‚Üì
API endpoint: POST /users/{userId}/like
           ‚Üì
–°–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç: –∞ –Ω–µ –ª–∞–π–∫–Ω—É–ª –ª–∏ B —É–∂–µ A?
           ‚Üì
                    ‚îå‚îÄ –î–ê ‚Üí MATCH!
                    ‚îÇ      –û–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket
                    ‚îÇ      –°–æ–∑–¥–∞—ë—Ç—Å—è —á–∞—Ç –º–µ–∂–¥—É –Ω–∏–º–∏
                    ‚îÇ
                    ‚îî‚îÄ –ù–ï–¢ ‚Üí –ø—Ä–æ—Å—Ç–æ like
                           –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ B –æ –Ω–æ–≤–æ–º –ª–∞–π–∫–µ
```

**–ù—é–∞–Ω—Å—ã:**

- –õ–∞–π–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Å–≤–∞–π–ø–µ –≤–ø—Ä–∞–≤–æ (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
- –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–∞–π–∫–∞ –ø—Ä–æ—Ñ–∏–ª—å —Å–¥–≤–∏–≥–∞–µ—Ç—Å—è —Å –∫–∞—Ä—É—Å–µ–ª–∏
- –ï—Å–ª–∏ –º–∞—Ç—á –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ª–µ—Ä—Ç (–∏–∑ SocketService)
- –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–≤–æ–π–Ω—ã–µ –ª–∞–π–∫–∏ —á–µ—Ä–µ–∑ API (400 Bad Request)

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å "—Å—É–ø–µ—Ä –ª–∞–π–∫" —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç –Ω–∞ –ª–∞–π–∫–∏ (–Ω–µ –±–æ–ª–µ–µ 20 –≤ —á–∞—Å)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É: –∫—Ç–æ –ª–∞–π–∫–Ω—É–ª, –æ—Ç–∫—É–¥–∞, –∫–æ–≥–¥–∞
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å "–∞–Ω–ª–∞–π–∫–∞" –≤ —Ç–µ—á–µ–Ω–∏–µ 1-2 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- –°–æ–∑–¥–∞–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ –∞–ª–µ—Ä—Ç—ã

**–§–∞–π–ª—ã:** `LikesViewModel.cs`, `LikesPage.xaml`

---

### üí¨ –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤ —Å –ø—Ä–µ–≤—å—é –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –û—Ç–ø—Ä–∞–≤–∫–∞ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- WebSocket —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–æ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä online —Å—Ç–∞—Ç—É—Å–∞
- –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ WebSocket:**

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```csharp
1. SocketService.ConnectAsync()
   ‚Üì
2. API –∑–∞–ø—Ä–æ—Å: POST /ws/start ‚Üí –ø–æ–ª—É—á–∏—Ç—å sessionToken
   ‚Üì
3. WebSocket URL: ws://api.host/ws/chat?session={token}
   ‚Üì
4. ClientWebSocket.ConnectAsync() ‚Üí –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
   ‚Üì
5. ListenAsync() ‚Üí —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ —Å–ª—É—à–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
```

#### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Å–æ–æ–±—â–µ–Ω–∏—è:

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—á–∞—Ç–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
           ‚Üì
–ù–∞–∂–∏–º–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
           ‚Üì
SendMessageAsync() ‚Üí JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è
           ‚Üì
–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ WebSocket
           ‚Üì
–°–µ—Ä–≤–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏ —Ä–∞—Å—Å—ã–ª–∞–µ—Ç –∞–¥—Ä–µ—Å–∞—Ç—É
           ‚Üì
ListenAsync() –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
           ‚Üì
–î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON ‚Üí WSMessage
           ‚Üì
OnMessageReceived?.Invoke() ‚Üí –≤—Å–µ –ø–æ–¥–ø–∏—Å—á–∏–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
           ‚Üì
MessagesViewModel –æ–±–Ω–æ–≤–ª—è–µ—Ç ObservableCollection
           ‚Üì
UI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (–±–ª–∞–≥–æ–¥–∞—Ä—è MVVM binding)
```

**–¢–∏–ø—ã WebSocket —Å–æ–±—ã—Ç–∏–π:**

- `Constants.Message` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `Constants.Match` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –º–∞—Ç—á–µ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ª–µ—Ä—Ç)

**–ù—é–∞–Ω—Å—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

1. **Buffer –¥–ª—è –º–Ω–æ–≥–æ–ø–∞–∫–µ—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π:**

   - WebSocket –º–æ–∂–µ—Ç —Ä–∞–∑–±–∏—Ç—å –±–æ–ª—å—à–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞–∫–µ—Ç–æ–≤
   - –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –ø–µ—Ä–≤—ã–º –ø–∞–∫–µ—Ç–æ–º (`result.Count`)
   - –ú–æ–∂–µ—Ç –ø–æ—Ç–µ—Ä—è—Ç—å—Å—è —á–∞—Å—Ç—å –±–æ–ª—å—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π > 4KB

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

   - –ü—Ä–∏ –æ—à–∏–±–∫–µ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ª–µ—Ä—Ç —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º JSON
   - –ü—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
   - –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

3. **–°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ñ–ª–∞–≥ `_isConnected` –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - `ConnectAsync()` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤—ã, –µ—Å–ª–∏ —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- **–ö–†–ò–¢–ò–ß–ù–û:** –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –º–Ω–æ–≥–æ–ø–∞–∫–µ—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (–¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π > 4KB)
- –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (—Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "heartbeat" –ø–∏–Ω–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–∏–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ UI (connected/disconnected)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `IAsyncDisposable` –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è WebSocket
- –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ, –µ—Å–ª–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –ø–æ—Ç–µ—Ä—è–Ω–æ, –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏
- –î–æ–±–∞–≤–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞

**–§–∞–π–ª—ã:** `ChatsViewModel.cs`, `MessagesViewModel.cs`, `SocketService.cs`, `WSMessage.cs`

---

### üìç –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –∏ —Å–µ—Ä–≤–∏—Å –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞/—Å—Ç—Ä–∞–Ω—ã
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ª–æ–∫–∞—Ü–∏–π –ø—Ä–∏ –≤–≤–æ–¥–µ
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—é –¥–æ –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**

```
LocationService.GetCurrentLocationAsync()
           ‚Üì
–ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —É –û–° (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
           ‚Üì
GPS –º–æ–¥—É–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (Latitude, Longitude)
           ‚Üì
–û–±—Ä–∞—Ç–Ω—ã–π –≥–µ–æ–∫–æ–¥–∏–Ω–≥ ‚Üí –ù–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (—á–µ—Ä–µ–∑ API)
           ‚Üì
–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
           ‚Üì
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö –ø–æ–∏—Å–∫–∞
```

**–ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ª–æ–∫–∞—Ü–∏–π:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç "–ú–æ—Å..."
           ‚Üì
LocationService.SearchLocationsAsync("–ú–æ—Å")
           ‚Üì
API –∑–∞–ø—Ä–æ—Å –∫ —Å–µ—Ä–≤–∏—Å—É –≥–µ–æ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
           ‚Üì
LocationSuggestion[] –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ Suggestions
           ‚Üì
UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫: "–ú–æ—Å–∫–≤–∞", "–ú–æ—Å—Ç–æ—á–Ω–∞—è", –∏ —Ç.–¥.
           ‚Üì
–ü—Ä–∏ –≤—ã–±–æ—Ä–µ: Location = "–ú–æ—Å–∫–≤–∞", Latitude/Longitude –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
```

**–ù—é–∞–Ω—Å—ã:**

- –†–∞–∑–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–ª—è Android/iOS (—Ç—Ä–µ–±—É–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ `/Platforms/`)
- –ú–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏
- GPS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏ (–Ω—É–∂–µ–Ω –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –¥–ª—è A-GPS)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `Preferences` –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö —Å–µ–∞–Ω—Å–æ–≤

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ IP-based –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é (–µ—Å–ª–∏ GPS –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω)
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –ª–æ–∫–∞—Ü–∏–π
- –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (Haversine formula)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–µ
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫—Ä—ã—Ç—å —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≥–æ—Ä–æ–¥/—Ä–µ–≥–∏–æ–Ω, –Ω–æ –Ω–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)

**–§–∞–π–ª—ã:** `LocationService.cs`, `LocationSuggestion.cs`, `Platforms/`

---

### ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è –∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**

- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–∏—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (–∏–º—è, –≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, –∏–Ω—Ç–µ—Ä–µ—Å—ã)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏ (–≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ—Ñ–∏–ª—è, –ø–æ–∫–∞–∑ –≤ –ø–æ–∏—Å–∫–µ)
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –ø–æ–∏—Å–∫–∞ (–≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–º –∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è–º–∏

**–õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–∑–º–µ–Ω—è–µ—Ç –ø–æ–ª–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω–∏–∫)
           ‚Üì
SettingsViewModel.OnPropertyChanged()
           ‚Üì
RelayCommand —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
           ‚Üì
–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
           ‚Üì
API –∑–∞–ø—Ä–æ—Å: PUT /profile { –ø–æ–ª—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è }
           ‚Üì
–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
           ‚Üì
–õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (CacheService)
           ‚Üì
UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

**–ù—é–∞–Ω—Å—ã:**

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–Ω–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ "—á–µ—Ä–Ω–æ–≤–∏–∫–∞")
- –ü—Ä–∏ –æ—à–∏–±–∫–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç–∫–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫ –ø–æ—Å–ª–µ–¥–Ω–∏–º –∏–∑–≤–µ—Å—Ç–Ω—ã–º
- –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ multipart/form-data

**‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤ –ø—Ä–æ—Ñ–∏–ª—è –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI (–∏–∑–º–µ–Ω–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ, –ø–æ—Ç–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å)
- –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã"
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ—Ñ–∏–ª—è
- –î–æ–±–∞–≤–∏—Ç—å –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–§–∞–π–ª—ã:** `SettingsViewModel.cs`, `SettingsPage.xaml`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Å–µ—Ä–≤–∏—Å—ã –¥–∞–Ω–Ω—ã—Ö

### 1Ô∏è‚É£ ApiService.cs ‚Äî REST API –∫–ª–∏–µ–Ω—Ç

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º—É REST API, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º, —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏.

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞:**

```
1. HTTP –∑–∞–ø—Ä–æ—Å –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç—Å—è
   ‚Üì
2. AddAuthHeader() –¥–æ–±–∞–≤–ª—è–µ—Ç Bearer token
   ‚Üì
3. SendWithRetry() –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å
   ‚Üì
4. –°—Ç–∞—Ç—É—Å 200-299? ‚Üí —É—Å–ø–µ—Ö, –≤–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   ‚Üì
5. –°—Ç–∞—Ç—É—Å 401? ‚Üí –ø–æ–ø—ã—Ç–∫–∞ –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω
   ‚îú‚îÄ –£—Å–ø–µ—à–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å
   ‚îî‚îÄ –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Üí –≤–µ—Ä–Ω—É—Ç—å 401 (–Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –≤—Ö–æ–¥)
   ‚Üì
6. –î—Ä—É–≥–∏–µ –æ—à–∏–±–∫–∏ ‚Üí –≤–µ—Ä–Ω—É—Ç—å HttpResponseMessage
```

**–ö–ª—é—á–µ–≤—ã–µ –Ω—é–∞–Ω—Å—ã:**

1. **Debug vs Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**

   - –í DEBUG –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å –∏–∑ `Constants.ApiBaseUrl`
   - –í RELEASE –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥—Ä–µ—Å –∏–∑ `Preferences` (–º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –±–µ–∑ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏!)
   - –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–¥–Ω–æ–π —Å–±–æ—Ä–∫–æ–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã

2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:**

   - –ü—Ä–∏ 401 –æ—à–∏–±–∫–µ –ø—ã—Ç–∞–µ—Ç—Å—è –æ–±–Ω–æ–≤–∏—Ç—å —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ `/refresh` endpoint
   - –ü–æ–≤—Ç–æ—Ä—è–µ—Ç –∑–∞–ø—Ä–æ—Å –æ–¥–∏–Ω —Ä–∞–∑ —Å –Ω–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
   - –ï—Å–ª–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å ‚Üí 401 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

3. **–ü—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
   - ‚ùå –ù–µ—Ç exponential backoff (—Ç–æ–ª—å–∫–æ 1 retry)
   - ‚ùå –ù–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ timeout (–º–æ–∂–µ—Ç –≤–∏—Å–µ—Ç—å 100 —Å–µ–∫)
   - ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–ª–æ–∂–Ω–æ –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å)
   - ‚úÖ **FIX:** –î–æ–±–∞–≤–∏—Ç—å loggin –∏ exponential backoff
   - ‚úÖ **FIX:** –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å timeout = 10 —Å–µ–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ fail

**–§–∞–π–ª—ã:** `ApiService.cs`, `Constants.cs`

---

### 2Ô∏è‚É£ CacheService.cs ‚Äî –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –ª–æ–∫–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π.

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
Level 1: ConcurrentDictionary (RAM) ‚Äî –±—ã—Å—Ç—Ä–æ (~1ms), –Ω–æ —Ç–µ—Ä—è–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ
                    ‚Üì
Level 2: SQLite (Disk) ‚Äî –º–µ–¥–ª–µ–Ω–Ω–µ–µ (~50-100ms), –Ω–æ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–µ–Ω
                    ‚Üì
Level 3: API (Network) ‚Äî —Å–∞–º—ã–π –º–µ–¥–ª–µ–Ω–Ω—ã–π (~500-2000ms)
```

**–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ—Ñ–∏–ª—è:**

```
1. –ï—Å—Ç—å –≤ RAM –∏ –Ω–µ —É—Å—Ç–∞—Ä–µ–ª (< 2 –¥–Ω–µ–π)? ‚Üí –≤–µ—Ä–Ω—É—Ç—å (~1ms)
2. –ù–µ—Ç? –ï—Å—Ç—å –≤ SQLite –∏ –Ω–µ —É—Å—Ç–∞—Ä–µ–ª?  ‚Üí –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤ RAM –∏ –≤–µ—Ä–Ω—É—Ç—å (~50ms)
3. –ù–µ—Ç? –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å API ‚Üí —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±–∞ –∫—ç—à–∞ (~500ms+)
4. –û—à–∏–±–∫–∞ API? ‚Üí –≤–µ—Ä–Ω—É—Ç—å –∑–∞–≥–ª—É—à–∫—É –∏–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å –∞–≤–∞—Ç–∞—Ä–∞–º–∏:**

- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∞–≤–∞—Ç–∞—Ä –æ–¥–∏–Ω —Ä–∞–∑
- URL –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å (–∏–∑ `AvatarCacheService`)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: 95%+ —Ç—Ä–∞—Ñ–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ö—ç—à –¥–µ–π—Å—Ç–≤—É–µ—Ç 2 –¥–Ω—è ‚Äî –µ—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –∏–∑–º–µ–Ω–∏–ª—Å—è, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ TTL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª—ã:** `CacheService.cs`, `IUpdatable.cs`

---

### 3Ô∏è‚É£ SocketService.cs ‚Äî WebSocket –¥–ª—è —Ä–µ–∞–ª-—Ç–∞–π–º–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —á–∞—Ç–∞—Ö –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π.

**–¶–∏–∫–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:**

```csharp
1. –ó–∞–ø—Ä–æ—Å sessi onToken: POST /ws/start
2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å HTTP ‚Üí WebSocket URL
3. ClientWebSocket.ConnectAsync()
4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ñ–æ–Ω–æ–≤—ã–π ListenAsync() (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI)
5. –°–ª—É—à–∞—Ç—å –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ü–∏–∫–ª–µ
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**

1. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –º–Ω–æ–≥–æ–ø–∞–∫–µ—Ç–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π (BUG!)**

   - WebSocket —Ä–∞–∑–±–∏–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è > 4KB –Ω–∞ –ø–∞–∫–µ—Ç—ã
   - –ö–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π –ø–∞–∫–µ—Ç (`result.Count`)
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–æ–ª—å—à–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç –¥–∞–Ω–Ω—ã–µ!

   **–ö–∞–∫ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**

   ```csharp
   var fullMessage = new StringBuilder();
   while ((result = await _ws.ReceiveAsync(buffer, ct)).MessageType != WebSocketMessageType.Close)
   {
       fullMessage.Append(Encoding.UTF8.GetString(buffer, 0, result.Count));
       if (result.EndOfMessage)  // ‚Üê –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–ª–∞–≥ –∫–æ–Ω—Ü–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
       {
           ProcessMessage(fullMessage.ToString());
           fullMessage.Clear();
       }
   }
   ```

2. **–ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**

   - –ü—Ä–∏ —Ä–∞–∑—Ä—ã–≤–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∞–ª–µ—Ä—Ç
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–∫–∞ –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - –ù—É–∂–Ω–∞ retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff

3. **–ù–µ—Ç heartbeat –ø–∏–Ω–≥–æ–≤**

   - –ü—Ä–æ–∫—Å–∏–∏ –º–æ–≥—É—Ç —Ä–∞–∑–æ—Ä–≤–∞—Ç—å "–º–µ—Ä—Ç–≤–æ–µ" —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
   - –ù—É–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –ø–∏–Ω–≥ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–∏–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

4. **–ù–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤**
   - `ClientWebSocket` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ù—É–∂–Ω–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è `IAsyncDisposable`

**–§–∞–π–ª—ã:** `SocketService.cs`, `WSMessage.cs`

---

### 4Ô∏è‚É£ AvatarCacheService.cs ‚Äî –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–æ–∫–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–æ–≤ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞.

**–õ–æ–≥–∏–∫–∞:**

```
AvatarUrl: "https://api.host/avatars/user123.jpg"
     ‚Üì
GetAvatarPathAsync(url)
     ‚îú‚îÄ –ù–∞ –¥–∏—Å–∫–µ? ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å
     ‚îî‚îÄ –ù–µ—Ç? ‚Üí –∑–∞–≥—Ä—É–∑–∏—Ç—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –≤–µ—Ä–Ω—É—Ç—å
     ‚Üì
UI –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –ø—É—Ç—å (0 —Ç—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–µ)
```

**–≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞:**

- –ü–µ—Ä–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è: 50-200KB
- –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä: 0KB (–∏–∑ –∫—ç—à–∞)
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 95%+ —Å–±–µ—Ä–µ–∂–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ

**‚ö†Ô∏è –£–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å —Å–∂–∞—Ç–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–∏–º–∏—Ç —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞ (—É–¥–∞–ª—è—Ç—å —Å—Ç–∞—Ä—ã–µ, –µ—Å–ª–∏ > 100MB)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebP –¥–ª—è –º–µ–Ω—å—à–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–æ–≤

**–§–∞–π–ª—ã:** `AvatarCacheService.cs`

---

### 5Ô∏è‚É£ LocationService.cs ‚Äî –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è, –ø–æ–∏—Å–∫ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º, –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.

**–ü—Ä–æ—Ü–µ—Å—Å:**

```
1. GetCurrentLocationAsync()
   ‚Üì
2. –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –û–° (–ø–µ—Ä–≤—ã–π —Ä–∞–∑)
   ‚Üì
3. GPS –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Latitude/Longitude (~5-50–º —Ç–æ—á–Ω–æ—Å—Ç—å)
   ‚Üì
4. –û–±—Ä–∞—Ç–Ω—ã–π –≥–µ–æ–∫–æ–¥–∏–Ω–≥: –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã ‚Üí –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞ (optional)
   ‚Üì
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ø—Ä–æ—Ñ–∏–ª—å
```

**–ù—é–∞–Ω—Å—ã:**

- –¢—Ä–µ–±—É–µ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π –∫–æ–¥ –≤ `/Platforms/Android/` –∏ `/Platforms/iOS/`
- GPS –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏ (–Ω—É–∂–µ–Ω A-GPS/Wi-Fi)
- –ü–æ–∏—Å–∫ –ª–æ–∫–∞—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ API –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ

**‚ö†Ô∏è –£–ª—É—á—à–µ–Ω–∏—è:**

- –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ IP-based –ª–æ–∫–∞—Ü–∏—é (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç GPS —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ > 1–∫–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á—ë—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è (Haversine formula)
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –Ω–∞ –∫–∞—Ä—Ç–∞—Ö

**–§–∞–π–ª—ã:** `LocationService.cs`, `LocationSuggestion.cs`

## ViewModel –ø–∞—Ç—Ç–µ—Ä–Ω –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç (MVVM)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**

```
View (XAML) ‚Üê Binding ‚Üí ViewModel ‚Üí Services/Models
  ‚Üë                         ‚Üì
  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
   (–ü—Ä–∏–≤—è–∑–∫–∞ 2-—Å—Ç–æ—Ä–æ–Ω–Ω—è—è!)
```

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –≤ TextBox
   ‚Üì
2. XAML binding –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç ViewModel —Å–≤–æ–π—Å—Ç–≤–æ
   ‚Üì
3. ViewModel –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –≤—ã—á–∏—Å–ª–µ–Ω–∏—è)
   ‚Üì
4. ViewModel –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª UI –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ OnPropertyChanged()
   ‚Üì
5. View (XAML) –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã
```

**–ü—Ä–∏–º–µ—Ä –¥–≤—É—Å—Ç–æ—Ä–æ–Ω–Ω–µ–π –ø—Ä–∏–≤—è–∑–∫–∏:**

```xaml
<Entry Text="{Binding UserName, Mode=TwoWay}" />
```

```csharp
[ObservableProperty]
private string userName = "";

// –ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç:
// Entry.Text ‚Üí OnPropertyChanged("UserName") ‚Üí View –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
// ViewModel –∏–∑–º–µ–Ω–∏—Ç UserName ‚Üí View –æ–±–Ω–æ–≤–ª—è–µ—Ç Entry.Text
```

### ObservableObject –∏ RelayCommand

**–ß—Ç–æ —ç—Ç–æ:**

```csharp
public partial class ExampleViewModel : ObservableObject
{
    // ObservableProperty –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:
    // 1. –ü—Ä–∏–≤–∞—Ç–Ω–æ–µ –ø–æ–ª–µ (_userName)
    // 2. –ü—É–±–ª–∏—á–Ω–æ–µ —Å–≤–æ–π—Å—Ç–≤–æ (UserName)
    // 3. OnPropertyChanged –≤—ã–∑–æ–≤—ã (–ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏)
    [ObservableProperty]
    private string userName = "";

    [ObservableProperty]
    private bool isLoading = false;

    // RelayCommand –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç:
    // 1. Command –æ–±—ä–µ–∫—Ç (–¥–ª—è XAML binding)
    // 2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã (–º–µ—Ç–æ–¥ –Ω–∏–∂–µ)
    // 3. CanExecute –ª–æ–≥–∏–∫—É
    [RelayCommand]
    public async Task LoadDataAsync()
    {
        IsLoading = true;
        try
        {
            // –õ–æ–≥–∏–∫–∞...
        }
        finally
        {
            IsLoading = false;  // UI –æ–±–Ω–æ–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
        }
    }
}
```

**–í XAML:**

```xaml
<Button Text="Load" Command="{Binding LoadDataCommand}" />
<ActivityIndicator IsRunning="{Binding IsLoading}" />
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. –ö–ª–∏–∫–Ω—É–ª–∏ Button
2. `LoadDataCommand` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
3. `IsLoading = true`
4. `ActivityIndicator` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è (–±–ª–∞–≥–æ–¥–∞—Ä—è binding)
5. –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `IsLoading = false`
6. `ActivityIndicator` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è

### –û—Å–Ω–æ–≤–Ω—ã–µ ViewModels

| ViewModel               | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                     | –ü—Ä–∏–º–µ—Ä—ã —Å–≤–æ–π—Å—Ç–≤                             |
| ----------------------- | ---------------------------------------------- | ------------------------------------------- |
| `LoginViewModel`        | –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –≤—Ö–æ–¥                          | `Email`, `Password`, `IsLoading`            |
| `ProfileViewModel`      | –ü—Ä–æ—Å–º–æ—Ç—Ä –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è | `UserProfile`, `IsEditing`, `SaveCommand`   |
| `SearchViewModel`       | –ö–∞—Ä—É—Å–µ–ª—å —Å–≤–∞–π–ø–∞ + —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞               | `CurrentUser`, `Filter`, `LikeCommand`      |
| `LikesViewModel`        | –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –ª–∞–π–∫–Ω—É–ª–∏         | `IncomingLikes`, `AcceptCommand`            |
| `ChatsViewModel`        | –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤                          | `ChatsList`, `UnreadCount`                  |
| `MessagesViewModel`     | –°–æ–æ–±—â–µ–Ω–∏—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —á–∞—Ç–µ                    | `Messages`, `CurrentMessage`, `SendCommand` |
| `SettingsViewModel`     | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–æ—Ñ–∏–ª—è                 | `PrivacySettings`, `SaveCommand`            |
| `ProfilePopupViewModel` | –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è –≤ –ø–æ–ø–∞–ø–µ              | `Profile`, `LikeCommand`, `RejectCommand`   |

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–º–µ—Ä: SearchViewModel

```csharp
public partial class SearchViewModel : ObservableObject
{
    private readonly ApiService _api;
    private readonly CacheService _cache;

    // Observable —Å–≤–æ–π—Å—Ç–≤–∞
    [ObservableProperty]
    private User? currentUser;

    [ObservableProperty]
    private bool isLoading = false;

    [ObservableProperty]
    private SearchFilter filter;

    // –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –ª–∞–π–∫–∞
    [RelayCommand]
    public async Task LikeUserAsync()
    {
        if (CurrentUser == null) return;

        try
        {
            IsLoading = true;
            await _api.LikeUserAsync(CurrentUser.Id);
            NextUser();  // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ
        }
        catch (Exception ex)
        {
            await Application.Current.MainPage?.DisplayAlert("Error", ex.Message, "OK");
        }
        finally
        {
            IsLoading = false;
        }
    }

    private void NextUser()
    {
        // –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        OnPropertyChanged(nameof(CurrentUser));  // –£–≤–µ–¥–æ–º–∏—Ç—å View –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    }
}
```

**–í XAML (SearchPage.xaml):**

```xaml
<StackLayout>
    <!-- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <Frame BindingContext="{Binding CurrentUser}">
        <Image Source="{Binding AvatarPath}" />
        <Label Text="{Binding DisplayName}" />
    </Frame>

    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
    <Grid ColumnDefinitions="*,*">
        <Button Text="‚ùå Pass" Grid.Column="0" Command="{Binding PassCommand}" />
        <Button Text="‚ù§Ô∏è Like" Grid.Column="1" Command="{Binding LikeCommand}" />
    </Grid>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <ActivityIndicator IsRunning="{Binding IsLoading}" />
</StackLayout>
```

**–ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–∏ –∫–ª–∏–∫–µ "Like":**

```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç Button "Like"
2. Command="{Binding LikeCommand}" –≤—ã–ø–æ–ª–Ω—è–µ—Ç LikeUserAsync()
3. IsLoading = true ‚Üí UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç ActivityIndicator
4. await _api.LikeUserAsync() ‚Üí –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
5. –ï—Å–ª–∏ —É—Å–ø–µ—Ö ‚Üí NextUser() ‚Üí CurrentUser –∏–∑–º–µ–Ω—è–µ—Ç—Å—è ‚Üí View –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
6. IsLoading = false ‚Üí ActivityIndicator —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è
7. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ ‚Üí DisplayAlert –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
```

### ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É ViewModels**

   - –ü—Ä–æ–±–ª–µ–º–∞: `SearchViewModel` –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ, –Ω–æ `ProfileViewModel` –Ω–µ –∑–Ω–∞–µ—Ç –æ–± —ç—Ç–æ–º
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Messenger` –ø–∞—Ç—Ç–µ—Ä–Ω –∏–∑ MVVM Toolkit

   ```csharp
   WeakReferenceMessenger.Default.Send(new UserLikedMessage { UserId = 123 });
   ```

2. **–£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ —Å–æ–±—ã—Ç–∏—è**

   - –ü—Ä–æ–±–ª–µ–º–∞: ViewModel –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ `Service.OnEvent`, –Ω–æ –Ω–µ –æ—Ç–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è
   - –†–µ—à–µ–Ω–∏–µ: —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å `IDisposable` –∏ –æ—Ç–ø–∏—Å–∞—Ç—å—Å—è –≤ destructor

3. **–ë–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏–µ UI –ø—Ä–∏ –¥–æ–ª–≥–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö**

   - –ü—Ä–æ–±–ª–µ–º–∞: –æ–ø–µ—Ä–∞—Ü–∏—è —Å –ë–î –∏–ª–∏ API –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫
   - –†–µ—à–µ–Ω–∏–µ: –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `async/await` –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π I/O

4. **ObservableProperty –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ**
   - –ü—Ä–æ–±–ª–µ–º–∞: `.GetAwaiter().GetResult()` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç UI
   - –†–µ—à–µ–Ω–∏–µ: –∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ `IAsyncRelayCommand` –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

### –ö–∞—Ä—É—Å–µ–ª—å –ø—Ä–æ—Ñ–∏–ª–µ–π (SearchViewModel)

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**

```
App –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
    ‚Üì
MauiProgram —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç Services (DI)
    ‚Üì
SearchPage —Å–æ–∑–¥–∞—ë—Ç SearchViewModel
    ‚Üì
SearchViewModel –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:
    ‚îú‚îÄ –ó–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã –∏–∑ StorageHelper
    ‚îú‚îÄ –ï—Å–ª–∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫: –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ –í—ã–∑—ã–≤–∞–µ—Ç LoadUsersAsync()
    ‚îÇ   ‚îú‚îÄ API –∑–∞–ø—Ä–æ—Å: GET /users/search?filter...&lastId=null&pageSize=20
    ‚îÇ   ‚îú‚îÄ –ü–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤—ã–µ 20 –ø—Ä–æ—Ñ–∏–ª–µ–π
    ‚îÇ   ‚îú‚îÄ –î–æ–±–∞–≤–ª—è–µ—Ç –≤ LimitedDeque
    ‚îÇ   ‚îî‚îÄ CurrentUser —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø–µ—Ä–≤–æ–≥–æ
    ‚îî‚îÄ UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç CurrentUser
```

**–ü—Ä–∏ —Å–≤–∞–π–ø–µ –≤–ø—Ä–∞–≤–æ (Like):**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É Like
    ‚Üì
LikeCommand –≤—ã–ø–æ–ª–Ω—è–µ—Ç LikeUserAsync()
    ‚îú‚îÄ IsLoading = true (UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç spinner)
    ‚îú‚îÄ API –∑–∞–ø—Ä–æ—Å: POST /users/{id}/like
    ‚îú‚îÄ –ï—Å–ª–∏ —É—Å–ø–µ—Ö:
    ‚îÇ   ‚îú‚îÄ _deque.MoveNext() (–ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —É–∫–∞–∑–∞—Ç–µ–ª—å)
    ‚îÇ   ‚îú‚îÄ CurrentUser –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
    ‚îÇ   ‚îú‚îÄ OnPropertyChanged() ‚Üí UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
    ‚îÇ   ‚îî‚îÄ –ï—Å–ª–∏ –æ—Å—Ç–∞–ª–æ—Å—å < 15 –ø—Ä–æ—Ñ–∏–ª–µ–π ‚Üí –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë
    ‚îî‚îÄ IsLoading = false (UI —Å–∫—Ä—ã–≤–∞–µ—Ç spinner)
```

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏:**

```
–ü–æ–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–º–æ—Ç—Ä–∏—Ç –ø—Ä–æ—Ñ–∏–ª–∏, —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç:

–ü—Ä–æ—Ñ–∏–ª—å 1 (—Å–º–æ—Ç—Ä–∏—Ç)
–ü—Ä–æ—Ñ–∏–ª—å 2-15 (–∑–∞–≥—Ä—É–∂–µ–Ω—ã, –≤ –ø–∞–º—è—Ç–∏)
–ü—Ä–æ—Ñ–∏–ª—å 16-20 (–∑–∞–≥—Ä—É–∂–µ–Ω—ã, –≤ –ø–∞–º—è—Ç–∏)
    ‚Üì
–ö–æ–≥–¥–∞ –æ—Å—Ç–∞—ë—Ç—Å—è 15 –ø—Ä–æ—Ñ–∏–ª–µ–π:
    ‚Üì
–§–æ–Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: GET /users/search?...&lastId=20&pageSize=20
    ‚Üì
–ü—Ä–æ—Ñ–∏–ª—å 21-40 –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ —Ñ–æ–Ω (–Ω–µ –±–ª–æ–∫–∏—Ä—É—è UI)
    ‚Üì
–ö –º–æ–º–µ–Ω—Ç—É, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–≤–∞–π–ø–Ω—ë—Ç –¥–æ 15-–≥–æ, 21-40 —É–∂–µ –≥–æ—Ç–æ–≤—ã
```

### –ß–∞—Ç—ã –∏ —Å–æ–æ–±—â–µ–Ω–∏—è (MessagesViewModel + SocketService)

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Ç
    ‚Üì
MessagesViewModel.OnAppearing()
    ‚Üì
SocketService.ConnectAsync()
    ‚îú‚îÄ –ï—Å–ª–∏ —É–∂–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–æ ‚Üí return (guard clause)
    ‚îú‚îÄ POST /ws/start ‚Üí –ø–æ–ª—É—á–∏—Ç—å sessionToken
    ‚îú‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å URL: http://api:8088 ‚Üí ws://api:8088/ws/chat?session=TOKEN
    ‚îú‚îÄ ClientWebSocket.ConnectAsync()
    ‚îú‚îÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å _ = ListenAsync() (—Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫)
    ‚îî‚îÄ _isConnected = true
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è:**

```
–î—Ä—É–≥–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
    ‚Üì
–°–µ—Ä–≤–µ—Ä –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —á–µ—Ä–µ–∑ WebSocket
    ‚Üì
ListenAsync() –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ —Ü–∏–∫–ª–µ
    ‚îú‚îÄ –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å bytes ‚Üí JSON ‚Üí WSMessage –æ–±—ä–µ–∫—Ç
    ‚îú‚îÄ –ï—Å–ª–∏ Type == "message":
    ‚îÇ   ‚îî‚îÄ OnMessageReceived?.Invoke(msg)  (—É–≤–µ–¥–æ–º–∏—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤)
    ‚îî‚îÄ –ï—Å–ª–∏ Type == "match":
        ‚îî‚îÄ DisplayAlert("Match!" ...) (–ø–æ–∫–∞–∑–∞—Ç—å –∞–ª–µ—Ä—Ç)
```

**MessagesViewModel –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:**

```
OnMessageReceived —Å–æ–±—ã—Ç–∏–µ –≤—ã–∑—ã–≤–∞–µ—Ç MessageReceived()
    ‚Üì
MessageReceived(message):
    ‚îú‚îÄ –°–æ–∑–¥–∞—Ç—å Message –æ–±—ä–µ–∫—Ç –∏–∑ WSMessage
    ‚îú‚îÄ Messages.Add(message) (ObservableCollection)
    ‚îú‚îÄ ObservableCollection —É–≤–µ–¥–æ–º–ª—è–µ—Ç UI –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏
    ‚îî‚îÄ UI –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ—Ç –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (ScrollToEnd)
```

**–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è:**

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –∏ –Ω–∞–∂–∏–º–∞–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å
    ‚Üì
SendCommand –≤—ã–ø–æ–ª–Ω—è–µ—Ç SendMessageAsync()
    ‚îú‚îÄ CurrentMessage = "" (–æ—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞)
    ‚îú‚îÄ –°–æ–∑–¥–∞—Ç—å WSMessage { Type="message", Content="...", ChatId=... }
    ‚îú‚îÄ SocketService.SendMessageAsync() ‚Üí —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ JSON
    ‚îú‚îÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ WebSocket (await)
    ‚îú‚îÄ –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π Messages —Å–ø–∏—Å–æ–∫
    ‚îú‚îÄ UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (LocalMessage –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å —Å–µ—Ä–≤–µ—Ä–∞)
    ‚îî‚îÄ –°–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ—Å—ã–ª–∞–µ—Ç –∞–¥—Ä–µ—Å–∞—Ç—É (–∏—Ö SocketService –ø–æ–ª—É—á–∏—Ç)
```

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π (CacheService)

**–ü–µ—Ä–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è:**

```
SearchViewModel –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å —Å API
    ‚Üì
CacheService.GetOrFetchUserProfileAsync(userId)
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RAM –∫—ç—à (_userProfileCache) ‚Üí –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQLite –∫—ç—à ‚Üí –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
    ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å API
    ‚îú‚îÄ –ï—Å–ª–∏ –µ—Å—Ç—å –∞–≤–∞—Ç–∞—Ä:
    ‚îÇ   ‚îî‚îÄ AvatarCacheService.GetAvatarPathAsync()
    ‚îÇ       ‚îú‚îÄ –ù–∞ –¥–∏—Å–∫–µ? ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ø—É—Ç—å
    ‚îÇ       ‚îî‚îÄ –ù–µ—Ç? ‚Üí –∑–∞–≥—Ä—É–∑–∏—Ç—å, —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å, –≤–µ—Ä–Ω—É—Ç—å
    ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ RAM –∫—ç—à (–±—ã—Å—Ç—Ä–æ)
    ‚îú‚îÄ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ SQLite (—Ñ–æ–Ω–æ–º, –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç UI)
    ‚îî‚îÄ –í–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
```

**–ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Ç–æ–≥–æ –∂–µ –ø—Ä–æ—Ñ–∏–ª—è:**

```
CacheService.GetOrFetchUserProfileAsync(userId)
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RAM –∫—ç—à ‚Üí –ù–ê–ô–î–ï–ù–û –∏ –Ω–µ —É—Å—Ç–∞—Ä–µ–ª–æ
    ‚îî‚îÄ –í–µ—Ä–Ω—É—Ç—å –∏–∑ RAM (~1ms)
       ‚Üë
    –ê–≤–∞—Ç–∞—Ä —É–∂–µ –≤ –ø–∞–º—è—Ç–∏, –Ω–µ —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è
```

**–ß–µ—Ä–µ–∑ 2 –¥–Ω—è:**

```
CacheService.GetOrFetchUserProfileAsync(userId)
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RAM –∫—ç—à ‚Üí –ù–ê–ô–î–ï–ù–û –Ω–æ —É—Å—Ç–∞—Ä–µ–ª–æ (IsExpired = true)
    ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SQLite –∫—ç—à ‚Üí –ù–ê–ô–î–ï–ù–û –Ω–æ —É—Å—Ç–∞—Ä–µ–ª–æ
    ‚îú‚îÄ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ —Å API
    ‚îî‚îÄ –û–±–Ω–æ–≤–∏—Ç—å –æ–±–∞ –∫—ç—à–∞
```

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ConcurrentDictionary` –¥–ª—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∞–≤–∞—Ç–∞—Ä—ã –Ω–∞ –¥–∏—Å–∫ (—ç–∫–æ–Ω–æ–º–∏—è 95% —Ç—Ä–∞—Ñ–∏–∫–∞)
- ‚úÖ –ü–∞–≥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞ (–Ω–µ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤—Å—ë —Ä–∞–∑–æ–º)
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** `.GetAwaiter().GetResult()` –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–µ (–∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–µ—Ç UI)
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ

### 2. –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å

- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É —Å exponential backoff –¥–ª—è API
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ WebSocket
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –º–Ω–æ–≥–æ–ø–∞–∫–µ—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è WebSocket
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –æ—à–∏–±–∫–∏ (—Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Bearer —Ç–æ–∫–µ–Ω—ã –≤ Authorization –∑–∞–≥–æ–ª–æ–≤–∫–µ
- ‚úÖ –û–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω –ø–µ—Ä–µ–¥ –∏—Å—Ç–µ—á–µ–Ω–∏–µ–º
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ Preferences
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–µ–Ω—Å–∏—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ –ª–æ–≥–∞—Ö

### 4. UX

- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å `ActivityIndicator` –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∏ –ø–æ–∑–∏—Ü–∏—é –º–µ–∂–¥—É —Å–µ–∞–Ω—Å–∞–º–∏
- ‚úÖ –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å offline mode (–ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- ‚ùå **–ò–∑–±–µ–≥–∞—Ç—å:** –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

---

## Build –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –î–ª—è Android

```bash
# Debug
dotnet publish -f net8.0-android -c Debug

# Release
dotnet publish -f net8.0-android -c Release
```

**–í—ã—Ö–æ–¥–Ω–æ–π —Ñ–∞–π–ª:** `bin/Release/net8.0-android/com.companyname.datingclient.apk`

### –î–ª—è iOS

```bash
# –¢—Ä–µ–±—É–µ—Ç—Å—è macOS
dotnet publish -f net8.0-ios -c Release
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "Unable to connect to API"

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ `ApiBaseUrl` –≤ `Constants.cs`
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ API —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

### –ü—Ä–æ–±–ª–µ–º–∞: "WebSocket connection failed"

**–†–µ—à–µ–Ω–∏–µ:**

- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL WebSocket —Å–µ—Ä–≤–µ—Ä–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—Ä—Ç –æ—Ç–∫—Ä—ã—Ç –≤ —Ñ–∞–π–µ—Ä–≤–æ–ª–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ SocketService

### –ü—Ä–æ–±–ª–µ–º–∞: "SQLite database locked"

**–†–µ—à–µ–Ω–∏–µ:**

- –ó–∞–∫—Ä–æ–π—Ç–µ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∫ –ë–î
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É –ë–î

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** November 13, 2025

**–í–µ—Ä—Å–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:** 1.0.0

**–í–µ—Ä—Å–∏—è .NET:** 8.0
